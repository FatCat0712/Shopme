<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
>
<head>
    <div th:replace="~{fragments :: page_head(${pageTitle}, 'none')}"></div>
    <link th:href="@{/star-rating/css/star-rating.css}" media="all" rel="stylesheet" type="text/css" />
    <script th:src="@{/star-rating/js/star-rating.js}" type="text/javascript"></script>
    <link th:href="@{/star-rating/themes/krajee-svg/theme.css}" media="all" rel="stylesheet" type="text/css" />
    <script th:src="@{/star-rating/themes/krajee-svg/theme.js}"></script>
</head>
<body>
<div id="spinner" class="show w-100 vh-100 bg-white position-fixed translate-middle top-50 start-50 d-flex align-items-center justify-content-center">
    <div class="spinner-grow text-primary" role="status"></div>
</div>
<div th:replace="~{navigation :: header_menu}">...</div>
<div class="container-fluid">
    <div class="container">
        <div th:if="${listCategoryParents != null && !#lists.isEmpty(listCategoryParents)}">
            <div class="row" style="margin-top: 120px;">
                <div class="col">
                    <nav>
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item">
                                <a class="text-decoration-none" th:href="@{/}">Home</a>
                            </li>
                            <th:block th:each="parent : ${listCategoryParents}">
                                <li class="breadcrumb-item">
                                    <a class="text-decoration-none" th:href="@{'/c/' + ${parent.getAlias()}}">[[${parent.name}]]</a>
                                </li>
                            </th:block>
                            <li class="breadcrumb-item" th:if="${product != null}">
                                <a th:href="@{'/p/' + ${product.alias}}">[[${product.shortName}]]</a>
                            </li>
                            <li class="breadcrumb-item" th:if="${product != null}">
                                Reviews
                            </li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-auto">
                <img th:src="${product.mainImagePath}" th:alt="${product.name}" style="width: 100px"/>
            </div>
            <div class="col-auto">
                <a th:href="@{'/p/' + ${product.alias}}" class="text-decoration-none text-dark">
                    <h5>[[${product.name}]]</h5>
                </a>

                <div class="row">
                    <div class="col-12 d-flex">
                        <div>
                            <a th:href="@{'/ratings/' + ${product.alias} + '/page/' +  ${currentPage}  + '?sortField=votes&sortDir=desc'}" class="text-decoration-none">Sort by most votes</a>
                        </div>
                        <div class="ms-3">
                            <a th:href="@{'/ratings/' + ${product.alias} + '/page/' + ${currentPage} + '?sortField=reviewTime&sortDir=desc'}" class="text-decoration-none">Sort by most recent</a>
                        </div>
                    </div>


                </div>

                <div class="row">
                    <div class="col-12 d-flex">
                        <div class="ml-2">
                            <div class="col-xs">
                                <input type="text" class="product-detail-rating-star" dir="ltr" data-size="md" th:value="${product.averageRating}">
                            </div>
                        </div>
                        <div class="col-xs ml-1 mt-3 text-muted">
                            <span th:replace="~{fragments :: format_number(${product.averageRating})}"></span> of 5
                        </div>
                    </div>
                </div>
                <div class="text-muted">
                    <small><span>[[${product.reviewCount}]]</span> ratings</small>
                </div>
            </div>
        </div>

        <div th:replace="~{review/reviews_votes :: content}"></div>
        <div th:replace="~{fragments :: pagination('/ratings/' + ${product.alias} ,'review')}"></div>
    </div>
</div>

<div th:replace="~{fragments :: modal_dialog}"></div>


<div th:replace="~{fragments:: footer}"></div>
</body>
<script>
    let csrfHeaderName = "[[${_csrf.headerName}]]";
    let csrfValue = "[[${_csrf.token}]]";
</script>
<script  th:src="@{/js/common_modal.js}"></script>
<script th:src="@{/js/common_rating.js}"></script>
<script  th:src="@{/js/review_vote.js}"></script>
</html>