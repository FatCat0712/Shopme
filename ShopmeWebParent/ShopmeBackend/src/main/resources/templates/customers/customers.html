<!DOCTYPE html>
<html lang="en"
    xmlns:th="http://www.thymeleaf.org">
<div th:replace="~{fragments :: page_head(${pageTitle}, 'tag')}">...</div>
<body class="sb-nav-fixed">
    <div class="container-fluid">
        <div th:replace="~{navigation :: menu}">...</div>
        <div id="layoutSidenav">
            <div th:replace="~{navigation :: side-nav }"></div>
            <div id="layoutSidenav_content">
                <main>
                    <div class="container-fluid px-4">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h2>Manage Customers</h2>
                                <ol class="breadcrumb mb-1">
                                    <li class="breadcrumb-item">
                                        <a th:href="@{/}" class="text-decoration-none view-link">Dashboard</a>
                                    </li>
                                    <li class="breadcrumb-item">
                                        <a  th:href="@{/customers}" class="text-decoration-none view-link">Customers</a>
                                    </li>
                                </ol>
                            </div>
                            <div>
                                <div th:if="${message != null}" class="alert alert-success text-center mb-0">
                                    [[${message}]]
                                </div>
                                <div th:if="${errorMessage != null}" class="alert alert-danger text-center mb-0">
                                    [[${errorMessage}]]
                                </div>
                            </div>
                        </div>


                        <div class="d-flex flex-column flex-sm-row justify-content-between align-items-center">
                            <div th:replace="~{fragments :: export_link('csv')}">...</div>
                            <div th:replace="~{fragments :: search_form}">...</div>
                        </div>

                        <div class="wrapper position-relative">
                            <div id="spinner-overlay">
                                <div class="spinner"></div>
                            </div>
                            <div class="full-details table-responsive-xl">
                                <table class="table table-bordered table-striped table-hover ">
                                    <thead class="thead-dark">
                                    <tr>
                                        <th th:replace="~{fragments :: column_link('id', 'ID', 'none')}">...</th>
                                        <th th:replace="~{fragments :: column_link('firstName', 'First Name', 'none')}">...</th>
                                        <th th:replace="~{fragments :: column_link('lastName', 'Last Name', 'none')}">...</th>
                                        <th  class="hideable-column" >
                                        <th th:replace="~{fragments :: column_link('email', 'Email Name', 'tag')}">...</th>
                                        </th>

                                        <th class="hideable-column">
                                        <th th:replace="~{fragments :: column_link('city', 'City', 'tag')}">...</th>
                                        </th>


                                        <th class="hideable-column">
                                        <th  th:replace="~{fragments :: column_link('state', 'State', 'tag')}">...</th>
                                        </th>

                                        <th th:replace="~{fragments :: column_link('country', 'Country', 'none')}">...</th>
                                        <th th:replace="~{fragments :: column_link('isEnabled', 'Enabled', 'none')}">...</th>
                                        <th>Action</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <th:block th:each="customer : ${listCustomers}">
                                        <tr>
                                            <td>[[${customer.id}]]</td>
                                            <td>[[${customer.firstName}]]</td>
                                            <td>[[${customer.lastName}]]</td>
                                            <td class="hideable-column">[[${customer.email}]]</td>
                                            <td class="hideable-column">[[${customer.city}]]</td>
                                            <td class="hideable-column">[[${customer.state}]]</td>
                                            <td>[[${customer.country.name}]]</td>
                                            <td>
                                                <div th:replace="~{fragments :: enable_link(${customer.isEnabled}, 'customer', '/customers/' + ${customer.id})}">...</div>
                                            </td>
                                            <td>
                                                <div>
                                                    <a class="link-detail text-decoration-none" th:href="@{'/customers/detail/' + ${customer.id}}" title="View details of this customer">
                                                       <i class="fas fa-file-alt fa-2x icon-green"></i>
                                                    </a>
                                                    &nbsp;
                                                    <div th:replace="~{fragments :: edit('customer', '/customers/edit/' + ${customer.id})}">...</div>
                                                    &nbsp;
                                                    <div th:replace="~{fragments :: delete('customer', ${customer.id}, '/customers/delete/' + ${customer.id}, true)}">...</div>
                                                </div>
                                            </td>
                                        </tr>
                                    </th:block>

                                    </tbody>
                                </table>
                            </div>

                            <div class="less-details">
                                <div th:each="customer : ${listCustomers}" class="card flex-row p-3 mb-3">
                                    <div class="col-6">
                                        <b>[[${customer.fullName}]]</b>
                                        <div>[[${customer.country.name}]]</div>
                                    </div>
                                    <div class="col-6">
                                        <div>
                                            <div th:replace="~{fragments :: enable_link(${customer.isEnabled}, 'customer', '/customers/' + ${customer.id})}">...</div>
                                            &nbsp;
                                            <a class="link-detail" th:href="@{'/customers/detail/' + ${customer.id}}" title="View details of this customer">
                                                <i class="fas fa-file-alt fa-2x icon-green "></i>
                                            </a>
                                            &nbsp;
                                            <div th:replace="~{fragments :: edit('customer', '/customers/edit/' + ${customer.id})}">...</div>
                                            &nbsp;
                                            <div th:replace="~{fragments :: delete('customer', ${customer.id}, '/customers/delete/' + ${customer.id}, true)}">...</div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>



                        <div th:replace="~{fragments :: pagination('customer')}">...</div>


                        <div class="modal fade" id="detailModal">
                            <div class="modal-dialog modal-lg modal-dialog-centered">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>


                        <div th:replace="~{modal_fragments :: confirm_modal}">...</div>
                    </div>
                </main>
            </div>
        </div>
    </div>
<script type="text/javascript">
    let moduleURL = "[[@{/customers}]]"
    $(".link-detail").on("click" ,function (e) {
        e.preventDefault();
        let linkDetailURL = $(this).attr("href");
        $("#detailModal").modal("show").find(".modal-content").load(linkDetailURL);
    })

    $(".link-delete").on("click", function(e) {
        e.preventDefault();
        let link = $(this);
        let entityName = 'customer';
        showDeleteConfirmModal(link, entityName);
    })
</script>
<script th:src="@{/js/common_list.js}"></script>
</body>
</html>